# Snapshot report for `tests/simple/simple.test.js`

The actual snapshot is saved in `simple.test.js.snap`.

Generated by [AVA](https://ava.li).

## should migrate and establish a connection

> Snapshot 1

    `-- ---------------------- --␊
    -- THIS FILE IS GENERATED --␊
    -- DO NOT EDIT            --␊
    -- ---------------------- --␊
    ␊
    DO $MAIN$␊
    DECLARE␊
        db_version integer;␊
    BEGIN␊
    CREATE EXTENSION IF NOT EXISTS "pgcrypto";␊
    ␊
    CREATE TABLE IF NOT EXISTS "qspg_metakeystore" (␊
        key_id character varying(255) PRIMARY KEY,␊
        integer_value integer,␊
        string_value character varying(255)␊
    );␊
    ␊
    IF NOT EXISTS (SELECT 1 FROM qspg_metakeystore WHERE key_id='db_version') THEN␊
        RAISE NOTICE 'Setting db_version to 0';␊
        INSERT INTO qspg_metakeystore (key_id, integer_value) VALUES ('db_version', 0);␊
    END IF;␊
    ␊
    db_version := (SELECT integer_value FROM qspg_metakeystore WHERE key_id='db_version');␊
    ␊
    RAISE NOTICE 'DATABASE VERSION = %', db_version;␊
    ␊
    -- --------------------------------------------␊
    -- VERSION 1␊
    -- --------------------------------------------␊
    ␊
    IF (db_version=0) THEN␊
        RAISE NOTICE 'Migrating db_version to 1';␊
    ␊
        -- File Name: v01.sql␊
        ␊
        CREATE TABLE test_people (␊
          name text␊
        );␊
        ␊
    ␊
        UPDATE qspg_metakeystore SET integer_value=1 WHERE key_id='db_version';␊
        db_version := (SELECT integer_value FROM qspg_metakeystore WHERE key_id='db_version');␊
    END IF;␊
    ␊
    -- --------------------------------------------␊
    -- VERSION 2␊
    -- --------------------------------------------␊
    ␊
    IF (db_version=1) THEN␊
        RAISE NOTICE 'Migrating db_version to 2';␊
    ␊
        -- File Name: v02.sql␊
        ␊
        ALTER TABLE test_people ADD COLUMN phone_number text;␊
        ␊
    ␊
        UPDATE qspg_metakeystore SET integer_value=2 WHERE key_id='db_version';␊
        db_version := (SELECT integer_value FROM qspg_metakeystore WHERE key_id='db_version');␊
    END IF;␊
    ␊
    ␊
    ␊
    END␊
    $MAIN$ LANGUAGE plpgsql;`
